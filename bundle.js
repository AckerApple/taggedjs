var t={d:(e,n)=>{for(var o in n)t.o(n,o)&&!t.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:n[o]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)},e={};function n(t){return t.renderCount=t.renderCount||0,t.varCounter=0,t.state={newer:{state:[],states:[]}},t.global={blocked:[]}}t.d(e,{W9:()=>Ns,cg:()=>I,m0:()=>k,rS:()=>Zo,Y2:()=>o,ei:()=>Us,B7:()=>q,TU:()=>Z,XF:()=>Ws,PC:()=>Hs,Ot:()=>Ts,Mj:()=>Vs,tD:()=>S,a:()=>ga,Gf:()=>c,xe:()=>sr,YO:()=>_s,b:()=>wa,rf:()=>Wr,br:()=>ha,um:()=>Zn,x6:()=>Er,E2:()=>$s,OH:()=>Bs,TB:()=>Ft,Ii:()=>Rt,mX:()=>mo,yV:()=>fe,EI:()=>de,zV:()=>G,pf:()=>us,ze:()=>Rs,Go:()=>ot,bD:()=>rt,WJ:()=>Q,wL:()=>vo,Ng:()=>$t,O:()=>ue,r3:()=>ra,y4:()=>Qr,Ie:()=>J,lI:()=>oa,hp:()=>Ae,qr:()=>na,ts:()=>fs,B4:()=>as,HD:()=>Gs,Az:()=>qn,Xi:()=>nr,sV:()=>To,Ah:()=>n,f5:()=>Me,Gk:()=>oo,j_:()=>ds,h1:()=>Br,h2:()=>Fr,h3:()=>_r,h4:()=>zr,h5:()=>Gr,h6:()=>Xr,zC:()=>Yo,d5:()=>Dr,wx:()=>ea,cF:()=>Ta,Hc:()=>So,PB:()=>Jt,uq:()=>It,hr:()=>Rr,qy:()=>or,gM:()=>Pr,gx:()=>Vr,hF:()=>Or,cy:()=>j,Tn:()=>P,Gv:()=>D,yL:()=>L,D8:()=>E,Ze:()=>A,_4:()=>O,mn:()=>M,Pf:()=>ma,o1:()=>sa,z:()=>Ps,li:()=>Zr,nf:()=>Nr,iW:()=>Yr,mI:()=>Hr,et:()=>kr,Vg:()=>$r,ol:()=>Kr,sA:()=>Fo,TG:()=>xo,MG:()=>$o,PL:()=>ao,uK:()=>Mr,CG:()=>ko,p:()=>ba,nI:()=>h,Fs:()=>Vo,AS:()=>aa,r5:()=>js,M$:()=>Ee,uc:()=>De,QB:()=>Oe,uW:()=>ta,Lt:()=>Ar,Jv:()=>Et,TA:()=>St,Jn:()=>At,Ll:()=>tt,vP:()=>ws,EX:()=>va,Ln:()=>ya,wk:()=>Wo,xP:()=>Ls,ko:()=>xa,iF:()=>Ur,bc:()=>Os,B1:()=>bo,RX:()=>fo,lR:()=>Ca,ag:()=>Fs,tp:()=>ca,Tc:()=>Qo,Hf:()=>rr,zc:()=>ht,_A:()=>so,T_:()=>fa,td:()=>ia,g0:()=>Lr,pd:()=>da,th:()=>la,VQ:()=>pa,DD:()=>jr,tr:()=>ua,ul:()=>qr,Ag:()=>cs,Pc:()=>Xt,NU:()=>dn,wB:()=>Ss,id:()=>Js,MC:()=>ks,SZ:()=>Is});class o{get(t){return"todo"}}function s(){return tt.stateConfig.support}function r(t){return Ks(t.context),tt.stateConfig.support=t}const a=function(){};function c(t){}let u=[];const i=[];let l=[],p=[],f=[];const d={locks:0,removeLocks:0};function g(t,e){e.textContent=t}function h(){d.locks>0||(++d.locks,function(){const t=i.length;(function(){for(const t of i)t[0](...t[1])})(),i.splice(0,t);for(const t of l)t[0](...t[1]);for(const t of p)t[0](...t[1]);for(const t of u)t[0](...t[1])}(),--d.locks,function(){u=[],l=[],p=[];const t=f;f=[];for(const e of t)e[0](...e[1])}())}function m(t,e){i.push([b,[t,e]])}function b(t,e){t.parentNode.removeChild(t)}function v(t,e,n){t.parentNode.insertBefore(e,t)}function y(t,e){t.appendChild(e)}const x="object"==typeof document&&document.createElement("div");function w(t){return x.innerHTML=t,document.createTextNode(x.innerHTML)}function C(t,e,n=a,o){const s=w(e);v(t,s),n(s)}function T(t,e,n=a){x.innerHTML=e;const o=document.createTextNode(x.textContent);v(t,o),n(o)}function V(t,e,n){x.innerHTML=e;const o=document.createTextNode(x.textContent);y(t,o),n(o)}const J="";var k,I;!function(t){t.string="string",t.number="number",t.boolean="boolean",t[void 0]="undefined"}(k||(k={})),function(t){t.function="function",t.date="date",t.unknown="unknown",t.object="object"}(I||(I={}));const S={tag:"html",dom:"dom",templater:"templater",tagComponent:"tagComponent",tagArray:"tagArray",host:"host",subscribe:"subscribe",signal:"signal",renderOnce:"renderOnce",stateRender:"stateRender",version:Date.now()};function E(t){switch(t){case k.string:case k.number:case k.boolean:return!0}return!1}function A(t){if(!t)return!1;switch(t.tagJsType){case S.dom:case S.tag:case S.templater:return!0}return!1}function M(t){const e=t?.tagJsType;return e===S.tagComponent||e===S.stateRender}function O(t){return D(t)&&typeof t.subscribe===I.function}function L(t){return t&&P(t.then)}function P(t){return typeof t===I.function}function D(t){return typeof t===I.object&&null!==t}function j(t){return Array.isArray(t)}function H(t){const e=t.state;return e&&e.newest&&e.newest?e.newest:t.parentContext?H(t.parentContext):void 0}function N(t){let e=t;for(;e.ownerSupport&&!M(e.templater);)e=e.ownerSupport;const n=e.context.state;return n&&n.newest||e}function U(...t){return t}function W(t){const e=tt.stateConfig;return e.states[e.statesIndex]=t,++e.statesIndex,t(U)}function $(t){const e=tt.stateConfig,n=e.statesIndex,o=N(e.prevSupport).context.state.older.states[n];let s=[];o((function(...t){return s=t,o.lastValues=s,t}));return e.states[e.statesIndex]=t,++e.statesIndex,t((function(...t){return s}))}function R(t){Ks(t);const e=tt.stateConfig;e.handlers.handler=z,e.handlers.statesHandler=W,e.rearray=[];const n=e.state=[],o=e.states=[];e.statesIndex=0;(t.state=t.state||{}).newer={state:n,states:o}}class B{}function F(t){const e=t.callback;if(!e)return t.defaultValue;const[n]=function(t){const[e]=t(B),[n]=t(e);return[e,n]}(e);return n}function _(){const t=tt.stateConfig,e=t.rearray[t.state.length];return t.state.push(e),e.defaultValue}function z(t){const e=tt.stateConfig,n=Gs();if(!n||!n.state){const t="State requested but TaggedJs is not currently rendering a tag or host";throw console.error(t,{config:e,context:n}),new Error(t)}const o=n.state.newer;e.state=o.state;let s=t;if(typeof t===I.function&&(s=t()),typeof s===I.function){const t=s;s=function(...e){return t(...e)},s.original=t}const r={get:function(){return F(r)},defaultValue:s};return e.state.push(r),s}function G(t){const e=new q;return e.subscribeWith=e=>{const n=[],o=[],s=(s,r)=>{n[r]=!0,o[r]=s;if(n.length===t.length){for(const t of n)if(!t)return;e(o,a)}},r=[...t],a=r.shift().subscribe((t=>s(t,0))),c=r.map(((t,e)=>t.subscribe((t=>s(t,e+1)))));return a.subscriptions=c,a},e}function X(t,e,n){const o=q.globalSubCount$;q.globalSubCount$.next(o.value+1);const s=function(){s.unsubscribe()};return s.callback=e,s.subscriptions=[],s.unsubscribe=function(){return function(t,e,n){!function(t,e){const n=t.findIndex((t=>t.callback===e));-1!==n&&t.splice(n,1)}(e,n);const o=q.globalSubCount$;q.globalSubCount$.next(o.value-1),t.unsubscribe=()=>t;const s=t.subscriptions;for(const t of s)t.unsubscribe();return t}(s,n,e)},s.add=t=>(s.subscriptions.push(t),s),s.next=t=>{e(t,s)},s}function K(t,e,n){const o=[...e],s=o.shift(),r=t=>{if(o.length)return K(t,o,n);n(t)};let a=r;const c=s(t,{setHandler:t=>a=t,next:r});a(c)}class q{onSubscription;methods=[];isSubject=!0;subscribers=[];subscribeWith;value;constructor(t,e){this.onSubscription=e,arguments.length>0&&(this.value=t)}subscribe(t){const e=X(0,t,this.subscribers),n=this.subscribeWith;if(n){if(this.methods.length){const n=t;t=t=>{K(t,this.methods,(t=>n(t,e)))}}return n(t)}return this.subscribers.push(e),this.onSubscription&&this.onSubscription(e),e}next(t){this.value=t,this.emit()}set=this.next.bind(this);emit(){const t=this.value,e=this.subscribers;for(const n of e)n.callback(t,n)}toPromise(){return new Promise((t=>{this.subscribe(((e,n)=>{n.unsubscribe(),t(e)}))}))}toCallback(t){const e=this.subscribe(((n,o)=>{const s=o?.unsubscribe;s?s():setTimeout((()=>e.unsubscribe()),0),t(n)}));return e}pipe(...t){const e=[];"value"in this&&e.push(this.value);const n=new q(...e);return n.setMethods(t),n.subscribeWith=t=>this.subscribe(t),n.next=t=>this.next(t),n}setMethods(t){this.methods=t}static all(t){return G(t.map((t=>{if(O(t))return t;return new q(t,(e=>(e.next(t),e)))})))}static globalSubCount$=new q(0)}class Z extends q{_value;constructor(...t){super(...t),this._value=t[0],Q(this)}next(t){this._value=t,this.emit()}emit(){const t=this._value,e=this.subscribers;for(const n of e)n.callback(t,n)}}function Q(t){Object.defineProperty(t,"value",{set(e){t._value=e,t.emit()},get:()=>t._value})}const Y=new q(void 0,(function(t){s()||t.next()})),tt={stateConfig:{state:[],version:Date.now(),handlers:{handler:z,statesHandler:W}},tagClosed$:Y};function et(t,e,n){if(e.deleted)return;const o=t[e.valueIndex],s=e.tagJsVar;Ks(e),s.processUpdate(o,e,n,t),qs(),e.value=o}function nt(t,e){const n=t.context.contexts;!function(t,e){const n=e.templater,o=e.templater.tag,s=n.values||o.values,r=t.templater.tag;r.values=s}(t,e),++d.locks,function(t,e){const n=t.templater.tag.values;for(const o of e)et(n,o,t)}(t,n),--d.locks,h()}function ot(t,e){return st(t,e)}function st(t,e){if(null===t||typeof t!==I.object)return t;if(e<0)return t;if(t instanceof Date)return new Date(t);if(t instanceof RegExp)return new RegExp(t);const n=j(t)?[]:Object.create(Object.getPrototypeOf(t));if(j(t))for(let o=0;o<t.length;o++)n[o]=st(t[o],e-1);else for(const o in t)Object.prototype.hasOwnProperty.call(t,o)&&(n[o]=st(t[o],e-1));return n}function rt(t,e,n){return at(t,e,n)}function at(t,e,n){return!(t!==e&&(o=t,s=e,!P(o)||!P(s)||o.toString()!==s.toString()))||(n<0||typeof t===I.object&&typeof e===I.object&&(t instanceof Date&&e instanceof Date?t.getTime()===e.getTime():j(t)&&j(e)?function(t,e,n){if(t.length!==e.length)return!1;for(let o=0;o<t.length;o++)if(!at(t[o],e[o],n-1))return!1;return!0}(t,e,n-1):!j(t)&&!j(e)&&function(t,e,n){const o=Object.keys(t),s=Object.keys(e);if(0===o.length&&0===s.length)return!0;if(o.length!==s.length)return!1;for(const r of o){if(!s.includes(r)||!at(t[r],e[r],n-1))return!1}return!0}(t,e,n-1)));var o,s}function ct(t){return t.map(ut)}function ut(t,e){const n=t,o=t?.tagJsType;if(o)switch(o){case S.signal:case S.subscribe:case S.stateRender:return;case S.dom:case S.tag:case S.templater:return ct(n.values)}return j(t)?ct(n):ot(t,e)}function it(t,e){const n=t.length;for(let o=0;o<n;++o){const n=t[o],s=e[o];if(j(n)&&j(s)){if(n===s)continue;return 3}if(typeof n!==I.function||typeof s!==I.function)if(typeof n!==I.object){if(n!==s)return 3.3}else if(typeof e===I.object){const t=Object.entries(n);for(const e of t){if(!lt(e,s))return 3.1}}}return!1}function lt([t,e],n){const o=n[t];return typeof e===I.function&&typeof o===I.function||o===e}function pt(t,e){const n=t.context.providers;if(n)for(const t of n)for(let n=t.children.length-1;n>=0;--n){t.children[n].context.global===e&&t.children.splice(n,1)}t.context.destroy$.next(),t.context.renderCount=0}function ft(t,e){for(const n of t){const t=n.lastArray;if(t){ft(t,e);continue}const o=n.value;if(o?.tagJsType===S.subscribe){o.destroy(n,e),n.deleted=!0;continue}const s=n.global;if(!s)continue;const r=n.state.newest,a=s.subscriptions;a&&a.forEach(gt),M(r.templater)&&pt(r,s);ft(n.contexts,r),s.deleted=!0}}function dt(t,e=[],n=[]){for(const o of t){const t=o.global;if(!t)continue;const s=o.state.newest;if(s){e.push(s);const o=t.subscriptions;o&&n.push(...o)}const r=o.contexts;r&&dt(r,e,n)}return{tags:e,subs:n}}function gt(t){t.unsubscribe()}function ht(t,e,n){const o=e.tagJsVar.tagJsType;return o&&["tag-conversion","element"].includes(o)?(e.tagJsVar.processUpdate(t,e,n,[]),e.value=t,0):t===e.value?0:(++e.updateCount,fs(e,t,n))}function mt(t,e,n,o,s){const r=e.context;r.locked=3,n.element=n.element||o,Ks(n),n.tagJsVar.processInit(t,n,e,s,o),qs(),n.value=t,delete r.locked}function bt(t){switch(t){case void 0:case!1:case null:return J}return t}function vt(t){if(t.startsWith("class."))return"class";const e=function(t){switch(t){case"autoselect":case"autoSelect":return"autoselect";case"autofocus":case"autoFocus":return"autofocus"}return!1}(t);return!1!==e?e:!!t.startsWith("style.")&&"style"}function yt(t,e,n,o){switch(o){case"autofocus":return void f.push([Vt,[n]]);case"autoselect":return void f.push([Tt,[n]]);case"style":{const o=t.split(".");return void l.push([xt,[n,o,e]])}case"class":return void function(t,e,n){const o=t.split(".");if(o.shift(),e){for(const t of o)l.push([wt,[n,t]]);return}for(const t of o)l.push([Ct,[n,t]])}(t,e,n)}throw new Error(`Invalid special attribute of ${o}. ${t}`)}function xt(t,e,n){const o=e[1];t.style[o]=n,t.style.setProperty(o,n)}function wt(t,e){t.classList.add(e)}function Ct(t,e){t.classList.remove(e)}function Tt(t){t.select()}function Vt(t){t.focus()}function Jt(t,e,n){if(D(n))return kt(t,e,n);l.push([St,[t,e,n]])}function kt(t,e,n){"object"!=typeof t[e]&&(t[e]={});for(const o in n){const s=n[o];l.push([Ot,[t,e,o,s]])}if(t[e].setProperty)for(const o in n){const s=n[o];l.push([Mt,[t,e,o,s]])}}function It(t,e,n){t.setAttribute(e,"")}function St(t,e,n){if(D(n))return kt(t,e,n);At(t,e,n)}function Et(t,e,n){t[e]=!!n}function At(t,e,n){t[e]=n,void 0!==n&&!1!==n&&null!==n?t.setAttribute(e,n):t.removeAttribute(e)}function Mt(t,e,n,o){t[e].setProperty(n,o)}function Ot(t,e,n,o){t[e][n]=o}function Lt(t,e,n,o,s,r,a){return n.element=o,n.howToSet=s,n.attrName=t,n.isSpecial=a,e?.tagJsType?function(t,e,n,o,s){e.processInitAttribute(t,e,s,e,n,o,St),n.tagJsVar=e}(t,e,n,r,o):Pt(t,e,o,s,a,n)}function Pt(t,e,n,o,s,r){return"function"==typeof e?function(t,e,n,o,s){const r=t(),c={tagJsType:"dynamic-attr",matchesInjection:t=>{const e=u.tagJsVar;if(e.matchesInjection)return e.matchesInjection(t,u)},hasValueChanged:(e,n,o)=>{const s=t();return u.tagJsVar.hasValueChanged(s,u,o)},processInit:a,processInitAttribute:a,destroy:(t,e)=>{u.tagJsVar.destroy(u,e)},processUpdate:(t,e,n,o)=>{++e.updateCount;const s=t();u.tagJsVar.processUpdate(s,u,n,o),u.value=s}},u={updateCount:0,isAttr:!0,element:o,parentContext:e,value:r,tagJsVar:Xt(r),valueIndex:-1,withinOwnerElement:!0,destroy$:new q,render$:new q},i={updateCount:0,isAttr:!0,contexts:[u],element:o,parentContext:e,value:t,tagJsVar:c,valueIndex:-1,withinOwnerElement:!0,destroy$:new q,render$:new q};return u.tagJsVar.processInitAttribute(n,r,o,u.tagJsVar,u,{},s),i}(e,r,t,n,o):s?yt(t,e,n,s):void o(n,t,e)}function Dt(t,e,n,o,s,r){const a=e.tagJsVar,c=t;if(a.hasValueChanged(c,e,n)>0){a.destroy(e,n),o.removeAttribute(s);const c=Xt(t);return c.isAttr=!0,c.processInitAttribute(s,t,o,c,e,n,r),void(e.tagJsVar=c)}}function jt(t,e,n,o,s,r,a){o.destroy=Ht,o.hasValueChanged=Rt,o.processUpdate=(e,o,s)=>Dt(e,o,s,n,t,a);const c=vt(t);Pt(t,e,n,a,c,s),s.tagJsVar=o}function Ht(t){const e=t.element,n=t.attrName;e.removeAttribute(n)}function Nt(t){return{tagJsType:"simple",value:t,processInitAttribute:jt,processInit:Wt,destroy:$t,hasValueChanged:Bt,processUpdate:Ut}}function Ut(t,e,n){return t===e.value?0:fs(e,t,n)}function Wt(t,e,n,o,s){const r=bt(t);o=e.placeholder;const a=e.paint=[C,[o,r,function(t){e.simpleValueElm=t,delete e.paint},"processSimpleValueInit"]];u.push(a)}function $t(t){if(!t.simpleValueElm&&t.paint)return void(t.paint[0]=a);const e=t.simpleValueElm;delete t.simpleValueElm,m(e,"deleteSimpleValue")}function Rt(t,e){return null==t||t===e.value?0:6}function Bt(t,e){return null!=t&&typeof t===I.object?($t(e),6):(function(t,e){const n=bt(t);if(e.paint)return void(e.paint[1][1]=n);const o=e.simpleValueElm;l.push([g,[n,o]])}(t,e),0)}function Ft(t,e){return j(t)?0:(ne(e),9)}function _t(t){return{tagJsType:"array",value:t,processInitAttribute:a,processInit:Gt,processUpdate:zt,hasValueChanged:Ft,destroy:ne}}function zt(t,e,n){if(++e.updateCount,Array.isArray(t))return void Zt(e,t,n);0===ht(t,e,n)&&Zt(e,t,n)}function Gt(t,e,n,o,s){Zt(e,t,n,s)}function Xt(t){const e=t?.tagJsType;return e?t:function(t){if(j(t))return _t(t);return Nt(t)}(t)}function Kt(t,e,n,o){return{updateCount:0,value:t,destroy$:new q,render$:new q,tagJsVar:Xt(t),withinOwnerElement:n,parentContext:o,valueIndex:o.varCounter}}function qt(t,e,n,o,s){const r=document.createTextNode(J),a=Kt(t,0,!0,e.context);return a.withinOwnerElement=!1,a.placeholder=r,s||(a.placeholder=o),mt(t,e,a,s,o),s&&p.push([y,[s,r]]),a}function Zt(t,e,n,o){const s=void 0===t.lastArray;s&&(t.lastArray=[]);const r=t.lastArray;let a=t.placeholder,c=0;const u=[];if(!s){for(let t=0;t<r.length;++t){const n=r[t],o=te(e,t,r,c);0!==o?2!==o?c+=o:t-=1:u.push(n)}t.lastArray=u}const i=e.length;for(let s=0;s<i;++s){a=Qt(e,s,t.lastArray,n,a,o).placeholder}}function Qt(t,e,n,o,s,r){const a=Yt(t[e]),c=n[e];if(c)return function(t,e,n,o,s,r,a){const c=n.length>s;if(c)return Array.isArray(t)?(e.tagJsVar.processUpdate(t,e,o,[]),e.value=t,e):(ht(t,e,o),e);const u=qt(t,o,0,r,a);return n.push(u),u}(a,c,n,o,e,s,r);const u=qt(a,o,0,s,r);return n.push(u),u}function Yt(t){if("function"==typeof t&&void 0===t.tagJsType){t=t()}return t}function te(t,e,n,o){const s=t.length-1,r=e-o,a=r<0||s<r,c=n[e];if(a)return ee(c),1;const u=function(t,e,n,o,s){const r=e&&t!==e.arrayValue;if(r)return ee(n),o.splice(s,1),2;return 0}(c.value.arrayValue,Yt(t[e]),c,n,e);return u}function ee(t){!function(t,e){if(t&&e.state?.oldest){return void ue(e.state.oldest,t)}e.tagJsVar.destroy(e,{})}(t.global,t)}function ne(t){++t.updateCount;oe(t,t.lastArray)}function oe(t,e){for(let t=0;t<e.length;++t)ee(e[t]);delete t.lastArray}function se(t){for(let e=t.length-1;e>=0;--e){re(t[e]),t.splice(e,1)}}function re(t){const e=t.marker;e&&m(e,"destroyMarker");m(t.domElement,"destroyClone")}function ae(t,e){!function(t,e){for(const n of t){if(n.withinOwnerElement){const t=n.tagJsVar;if(t&&"host"===t.tagJsType){const o=n.supportOwner,s=t.destroy(n,o);L(s)&&e.push(s)}continue}const t=n.lastArray;if(t){oe(n,t);continue}const o=n.simpleValueElm;if(o){delete n.simpleValueElm,m(o,"smartRemoveByContext");continue}const s=n.global;if(void 0===s)continue;s.deleted=!0;const r=n.state?.oldest;r&&ae(n,e)}}(t.contexts,e),ce(t)}function ce(t){se(t.htmlDomMeta)}function ue(t,e){const n=t.context;e.deleted=!0,n.renderCount=0;const o=[];return ft(n.contexts,t),t.templater.wrapper&&pt(t,e),ae(n,o),delete n.state,delete n.contexts,delete n.returnValue,delete n.providers,o}function ie(t,e){const n=le(t,e);return!(n||!e.templater.tag?._innerHTML||!le(t.outerHTML,e))||n}function le(t,e){const n=t.templater,o=e.templater,s=n?.tag||t,r=o.tag;if(n?.tagJsType===S.stateRender)return n.dom===o.dom;switch(s.tagJsType){case S.dom:return r?.tagJsType===S.dom&&function(t,e){const n=t.dom,o=e.dom;return n===o}(s,r);case S.tag:{const n=function(t,e,n,o){const s=t.strings,r=e.strings;if(s.length!==r.length)return!1;if(!s.every(((t,e)=>r[e].length===t.length)))return!1;const a=n.templater.values||t.values,c=o.templater.values||e.values;return function(t,e){const n=t.length===e.length;if(!n)return!1;const o=e.every((function(e,n){const o=t[n];if(typeof e===I.function&&typeof o===I.function){return!!(e.toString()===o.toString())}return!0}));if(o)return!0;return!1}(a,c)}(s,r,t,e);return n}}throw new Error(`unknown tagJsType of ${s.tagJsType}`)}function pe(t){++t.updateCount;const e=t.global;ue(t.state.newest,e),function(t){t.htmlDomMeta=[],delete t.contexts,delete t.state,delete t.global,t.renderCount=0}(t)}function fe(t,e){const n=e.state?.newest;if(A(t)){return ie(t,n)?0:7}const o=t?.tagJsType;return o?t.wrapper?.original===e.value.wrapper?.original?0:88:8}function de(t,e){const o=e.global,s=e.state?.newest;if(A(t)){return ie(t,s)?(ls(e,t,s),0):(ue(s,o),n(e),7)}const r=t?.tagJsType;if(r){return!0===ls(e,t,e.state.newest.ownerSupport)?0:88}return pe(e),8}function ge(t,e,n,o,s,r,a){const c=document.createTextNode(J),i=function(t,e,n,o){const s=Kt(t,0,n,o);return e.push(s),++o.varCounter,s}(t,e,s>0,o);return i.placeholder=c,i.element=r,r?p.push([y,[r,c]]):u.push([v,[a,c,"attachDynamicDom.attachDynamicDom"]]),mt(t,n,i,r,a),i}function he(t,e){const n=function(t,e,n=[]){const o=t.context;n.push({support:t,renderCount:o.renderCount,provider:e});const s=e.children;for(let t=s.length-1;t>=0;--t){const o=s[t],r=o.context;n.push({support:o,renderCount:r.renderCount,provider:e})}return n}(t,e);return n}function me(t){return t.support}function be(t){const e=t.context;return Pe(t.templater)?je(t):Le(t,t,e)}function ve(t,e,n){return t}function ye(t){return typeof t!==I.object||!t||t.tagJsType}function xe(t,e,n,o,s,r){return null==t||r>s?e:typeof t===I.function?e.mem?(t.mem=e.mem,e):(t.mem=e,t):ye(e)?e:j(e)?function(t,e,n,o,s,r){for(let a=t.length-1;a>=0;--a){const c=t[a],u=e[a];t[a]=xe(u,c,n,o,r,s+1)}return t}(e,t,n,o,r,s):function(t,e,n,o,s,r){const a=Object.keys(t);for(const c of a){const a=t[c],u=xe(e[c],a,n,o,r,s+1);if(a===u)continue;const i=Object.getOwnPropertyDescriptor(t,c)?.set;i||(t[c]=u)}return t}(e,t,n,o,r,s)}function we(t,e,o){const s=o.global,r=o.state.newest,a=r.templater.wrapper;let c=e.templater.wrapper,u=!1;const i=e.templater.tagJsType,l=S.stateRender===i||S.renderOnce===i;if(l)u=e.templater.tagJsType===S.renderOnce||ie(r,e);else if(a&&c){const t=r.templater.tag?._innerHTML;t&&(c=e.outerHTML);u=a.original===c.original}const p=e.templater;if(!u)return void function(t,e,o){const s=t.global;ue(t.state.oldest,s),n(t),e.processInit(e,t,o,t.placeholder)}(o,p,t);const f=l||function(t,e){const n=e.props,o=t.propsConfig,s=o.latest,r=Yo(n,s,t.templater.propWatch);return r}(r,p);if(f)o.locked?s.blocked.push(e):(De(e),++o.renderCount);else{!function(t,e,n,o,s){const r=t.props,a=Ce(e,n,o,r,s),c=e.propsConfig;c.castProps=a;const u=n.propsConfig;u.latest=c.latest}(p,e,r,t,p.propWatch===Zo.DEEP?os:ns)}}function Ce(t,e,n,o,s,r=-1){const a=e.context;if(!a.global||!a.state.newest){const e=ve(o);o.push(...e);return t.propsConfig.castProps=e,o}const c=(e=a.state.newest||e).propsConfig.castProps,u=[];for(let e=0;e<o.length;++e){const a=o[e],i=xe(c[e],a,t,n,s,r+1);u.push(i)}return t.propsConfig.castProps=u,u}function Te(t){const e=t.context,o=e.global,{subs:s,tags:r}=dt(e.contexts);Ve(e);for(const t of r){if(!0===t.context.global.deleted)return;Ve(t.context)}o.subscriptions&&s.forEach(gt),n(e)}function Ve(t){t.global.deleted=!0,ae(t,[]),delete t.contexts}function Je(t,e,n,o){const s=e.original,a=t.tagJsType===S.stateRender,c=tt.stateConfig;let u;return r(n),a?u=t():(u=s(...o),typeof u===I.function&&void 0===u.tagJsType&&(u=u())),n.context.returnValue=u,n.returnValue=u,u.templater=t,t.tag=u,n.context.state.newer={...c},qs(),n}function ke(t){!function(t){const e=tt.stateConfig,n=t||e.context;n.state=n.state||{},n.state.newer={...e};const o=e.support;n.state.newest=o}(t),function(){const t=tt.stateConfig;delete t.prevSupport,delete t.support,delete t.state,delete t.states,qs()}()}function Ie(t,e,n,o){let s;const r=t.templater;if(r.tagJsType===S.stateRender){const e=r;s=is(r,n,o,t.appSupport),Je(r,e,s)}else{s=(0,r.wrapper)(t,n,e)}return function(t,e){++t.context.renderCount,ke(t.context),tt.tagClosed$.next(e)}(s,o),s.ownerSupport=t.ownerSupport,s}function Se(t){const e=tt.stateConfig;return e.rearray=t,e.state=[],e.states=[],e.statesIndex=0,e.handlers.handler=_,e.handlers.statesHandler=$,e}function Ee(t,e,n,o){return function(t,e,n){Se(n),tt.stateConfig.prevSupport=e,r(t)}(t,e,n.state.older.state),Ie(t,e,n,o)}function Ae(t,e,n,o){R(t.context),r(t);const s=Ie(t,e,n,o);return qs(),s}function Me(t){const e=t?.context,n=e?.state;return n?.older?.state}function Oe(t,e,n){let o;o=Me(e)?Ee(t,e,n):Ae(t,e,n);const s=!e||ie(e,o);if(s){if(e){const t=e.templater.tag;if(t&&n.renderCount>0){const n=e?.templater,o=n?.tag;!function(t,e,n){if(t.tagJsType===S.dom){const o=n?.dom;return void(o!==t.dom&&Te(e))}if(n){const o=n.strings;if(o){const n=o?.length;n!==t.strings.length&&Te(e)}}}(t,e,o)}}}else{!function(t,e){const n=t.context,o=n.global;let s=-1;const r=n.providers=n.providers||[],a=r.length-1;for(;s++<a;){const t=r[s];let n=-1;const a=t.children.length-1;for(;n++<a;)if(o===t.children[n].context.global)return t.children.splice(n,1),void t.children.push(e)}}(e,o),Te(e);const t=o.context;t.state.oldest=o,t.state.newest=o}return o.ownerSupport=t.ownerSupport,{support:o,wasLikeTags:s}}function Le(t,e,n){const o=Oe(e,t,n);if(o.wasLikeTags){return nt(n.state.oldest,o.support),o.support}return Qn(e,n)}function Pe(t){return S.templater===t.tagJsType}function De(t){const e=t.context,n=e.global,o=Pe(t.templater);if(e.locked)return n.blocked.push(t),t;if(o){return je(t)}e.locked=4,n.blocked.length&&(t=n.blocked.pop(),n.blocked=[]);const s=Le(e.state.newest,t,e);return delete e.locked,s}function je(t){return De(N(t).context.state.newest)}function He(t,e){const n=e.context.global;if(n&&n.deleted)return!1;const o=function(t,e){const n=t.props,o=e.propsConfig,s=o.latest;if(Ne(n,s))return!0;switch(t.propWatch){case Zo.IMMUTABLE:return es(n,s);case Zo.SHALLOW:return it(n,s)}return!rt(n,s,os)}(t,e);return!!o}function Ne(t,e){return t.length!==e.length}function Ue(t,e=[]){const n=t.context,o=Pe(t.templater),s=t.ownerSupport;if(n.locked)return e.push(t),e;if(o)return Ue(s,e);const r=t.context.global;if(r&&!0===r.deleted)return e;const a=t,c=M(a.templater),u=t.templater.tagJsType,i=s&&u!==S.stateRender&&(!c||He(a.templater,a));if(a.context.providers){const t=function(t){const e=t.context.providers;if(!e)return[];const n=[];for(const t of e){const e=he(t.owner,t);n.push(...e.map(me))}return n}(a);e.push(...t)}return i?(Ue(s,e),c&&e.push(a),e):(e.push(a),e)}function We(t){++d.locks,t.forEach($e),--d.locks,h()}function $e(t){const e=t.context;if(!e.global)return void e.tagJsVar.processUpdate(e.value,e,t.ownerSupport,[]);De(e.state.newest)}function Re(t,e){for(let n=0;n<t.length;++n){ze(t[n],e[n])}}let Be;function Fe(...t){return Be=t,t}function _e(){return Be}function ze(t,e){t(Fe,1),e(_e,2)}function Ge(t,e,n,o){for(let n=t.length-1;n>=0;--n){const o=t[n].get(),s=e[n].callback;s&&s(o)}for(let t=o.length-1;t>=0;--t){Ke.length=0,Xe=0;(0,o[t])(qe),n[t](Ze)}}let Xe=0;const Ke=[];function qe(...t){return Ke.push(t),t}function Ze(...t){return Ke[Xe++]}function Qe(t,e,{resolvePromise:n,resolveValue:o}){if(L(t)){return e.context.locked=2,t.then(function(t,e){return n=>{const o=t.context,s=o.global;if(delete o.locked,!0===o.deleted||!0===s?.deleted)return e(n);!function(t,e){const n=t.context.state,o=e.context.state;Re(n.newer.states,o.newer.states)}(t,o.state.newest);return We(Ue(t)),e(n)}}(e,n))}return o(t)}function Ye(t,e){const n=e.context.global,o=function(t,e){if(!0!==n.deleted)return function(t,e,n,o){const s=N(e),r=s.context;r.locked=1;const a=t.apply(n,o);delete r.locked;return tn(a,s)}(o.tagFunction,o.support,t,e)};return o.tagFunction=t,o.support=e,o}function tn(t,e){const n=e.context.global;if(n?.deleted)return;return We(Ue(e)),Qe(t,e,{resolvePromise:on,resolveValue:sn})}const en="no-data-ever",nn="promise-no-data-ever";function on(){return nn}function sn(){return en}function rn(t,e,n){const o=n[e];if(o){let e=!1;if(t.originalStopPropagation=t.stopPropagation,t.stopPropagation=function(){e=!0,t.originalStopPropagation.call(t),t.stopPropagation=t.originalStopPropagation,delete t.originalStopPropagation},o(t),t.defaultPrevented||e)return}const s=n.parentNode;s&&rn(t,e,s)}function an(t,e,n,o){const s=t.appElement,r=function(t){"blur"===t&&(t="focusout");return"_"+t}(e);"blur"===e&&(e="focusout");const a=t.context.events;if(!a[e]){const t=function(t){rn(t,r,t.target)};a[e]=t,s.addEventListener(e,t)}n[r]=o,n[e]=o}function cn(t,e,n,o){const s=function(...e){return s.tagFunction(t,e)};s.tagFunction=e,s.support=n,an(n.appSupport,o,t,s)}function un(t){return null==t||!1===t}function ln(t,e,n,o,s,r,a){if(un(e))return;const c=[];if(typeof e===I.object){for(const s in e){const u=vt(s),i=yn(s,e[s],t,n,o,St,r,a,u);void 0!==i&&(Array.isArray(i)?c.push(...i):c.push(i))}return c}0!==e.length&&s(n,e,J)}function pn(t,e){t.removeAttribute(e)}function fn(t,e,n,o){const s=e,r=t;if(r?.tagJsType){const o=e.value;return o?.tagJsType?void o.hasValueChanged(r,e,n):(r.isAttr=!0,Ks(e),r.processInitAttribute(s.attrName,t,s.element,r,s,n,St),qs(),void(s.tagJsVar=r))}if(s.isNameOnly)return function(t,e,n,o,s,r,a,c){if(n){if(un(e)||""===e)return void o.removeAttribute(n);if(typeof n===I.object)if(typeof e===I.object)for(const t in n)t in e||l.push([pn,[o,t]]);else for(const t in n)l.push([pn,[o,t]])}const u=ln(t,e,o,s,r,a,c);u&&a.push(...u)}(o,t,s.value,s.element,n,s.howToSet,[],s.parentContext),void(s.value=t);const a=s.element;!function(t,e,n,o,s,r,a){if(P(t))return function(t,e,n,o,s,r,a){const c=t.templater.wrapper;if((c?.tagJsType||c?.original?.tagJsType)!==S.renderOnce)return wn(e,t,o,n);return xn(e,n,o,s,r,t)}(s,t,o,e,a,r);xn(t,o,e,a,r,s)}(t,s.attrName,0,a,n,s.howToSet,s.isSpecial),e.value=t}const dn=":tagvar",gn=":",hn=new RegExp(dn+"(\\d+)"+gn,"g");function mn(t){return t.search&&t.startsWith(dn)?t.search(hn):-1}function bn(t,e,n,o,s,r,a){const c=o.length,u=[];function i(o){const r=function(t,e,n){return t.reduce(((t,o)=>{if(mn(o)>=0){const o=n++,s=e[o];return t.push(s),t}return t.push(o),t}),[])}(e,o,c).join("");s(n,t,r)}return e.forEach((e=>{if(mn(e)>=0){const s=o.length,c=Xt(e),l={updateCount:0,isAttr:!0,element:n,attrName:t,withinOwnerElement:!0,tagJsVar:c,valueIndex:a.varCounter,parentContext:a,destroy$:new q,render$:new q};c.processUpdate=function(t,e,n,o){++e.updateCount,i(o)};const p=r[s];l.value=p,u.push(l),++a.varCounter}})),i(r),u}function vn(t){return D(t)&&"tagJsVar"in t?t.tagJsVar:-1}function yn(t,e,n,o,s,r,a,c,u){const i=vn(t);let l=i>=0||void 0===e&&"string"!=typeof t,p=n[i];e?.tagJsType?p=e:t?.tagJsType&&(l=!0,p=t,e=t);const f=p;if(f?.tagJsType)return function(t,e,n,o,s,r,a,c,u){const i=Kt(t,0,!0,n);return i.element=c,i.valueIndex=s,i.isAttr=!0,i.isNameOnly=u,i.stateOwner=N(r),i.supportOwner=r,Ks(i),o.processInitAttribute(a,t,c,o,i,r,St),qs(),i.oldTagJsVar=i.tagJsVar,i.tagJsVar=o,i}(e,0,c,f,i,s,t,o,l);if(l){-1===i&&l&&(p=t);const e=Kt(p,0,!0,c);e.valueIndex=i,e.isAttr=!0,e.element=o,e.isNameOnly=!0,e.howToSet=r;e.tagJsVar.processUpdate=fn;const u=ln(n,p,o,s,r,a,c);return u&&a.push(...u),e}if(Array.isArray(e))return bn(t,e,o,[],r,n,s.context);const d=vn(e);if(d>=0){return function(t,e,n,o,s,r,a,c,u){if(typeof e===I.function)return++s.varCounter,wn(e,a,t,n);const i=Xt(e),l={updateCount:0,isAttr:!0,element:n,attrName:t,howToSet:r,value:e,withinOwnerElement:!0,tagJsVar:i,destroy$:new q,render$:new q,valueIndex:u,parentContext:s};return o.push(l),i.processUpdate=fn,Lt(t,e,l,n,r,a,c),l.value=e,l}(t,n[d],o,[],c,r,s,u,d)}return Pt(t,e,o,r,u,c)}function xn(t,e,n,o,s,r){if(!1===o){switch(t){case void 0:case!1:case null:return void l.push([Cn,[e,n]])}if(P(t))return cn(e,t,r,n);s(e,n,t)}else yt(n,t,e,o)}function wn(t,e,n,o){return cn(o,t=Ye(t,e),e,n)}function Cn(t,e){t.removeAttribute(e)}function Tn(t,e,n,o,s){for(const r of t){const t=r[0],a=r[1],c=r[2]||!1;let u=r.length>1?St:It;r[3]&&(u=r[3]);const i=s.contexts,l=yn(t,a,e,n,o,u,i,s,c)||void 0;"object"==typeof l&&(i.push(l),++s.varCounter)}}function Vn(t,e,n,o,s,r,a){e.at&&Tn(e.at,n,t,o,s),r?p.push([y,[r,t,"appendToAttachDomElement"]]):u.push([v,[a,t,"insertBeforeAttachDomElement"]])}function Jn(t,e,n,o,s,r,a){const c=n.context,u=c.contexts;o=c;const i=[];r&&void 0===a&&(a=document.createTextNode(J),p.push([y,[r,a]]),r=void 0);for(let c=0;c<t.length;++c){const l=t[c],p=l.v;if(!isNaN(p)){const t=Number(p),c=e[t];if(P(c)&&void 0===c.tagJsType){++o.varCounter;continue}ge(c,u,n,o,s,r,a).valueIndex=t;continue}const f={};if(i.push(f),"text"===l.nn){kn(f,l,r,a);continue}const d=f.domElement=document.createElement(l.nn),g={updateCount:0,isAttrs:!0,element:d,parentContext:o,contexts:[],destroy$:new q,render$:new q,tagJsVar:{tagJsType:"new-parent-context"},valueIndex:-1,withinOwnerElement:!0,varCounter:0};Vn(d,l,e,n,g,r,a),g.element=d,l.ch&&(f.ch=Jn(l.ch,e,n,g,s+1,d,a).dom)}return{dom:i,contexts:u}}function kn(t,e,n,o){const s=t,r=s.tc=e.tc;n?p.push([V,[n,r,function(t){s.domElement=t}]]):u.push([T,[o,r,function(t){s.domElement=t}]])}const In=/(:tagvar\d+:)/,Sn="ondoubleclick",En=/([:_a-zA-Z0-9\-.]+)\s*(?:=\s*"([^"]*)"|=\s*(\S+))?/g,An=/<\/?([a-zA-Z0-9-]+)((?:\s+[a-zA-Z_:*][\w:.-]*(?:\s*=\s*(?:"[^"]*"|'[^']*'|[^\s"'=<>`]+))?)+\s*|\s*)\/?>/g;function Mn(t){const e=[],n=[],o=[];let s=null,r=-1,a=0;const c=new RegExp(An,"g");for(t=function(t){return t.replace(On,(function(t){return t.replace(/\[l t\]/g,"[l&nbsp;t]").replace(/\[g t\]/g,"[g&nbsp;t]").replace(/</g,"[l t]").replace(/>/g,"[g t]")}))}(t);a<t.length;){const u=c.exec(t);if(!u)break;const[i,l,p]=u,f=i.startsWith("</"),d=i.endsWith("/>");if(a<u.index){const e=t.slice(a,u.index);if(e.trim()){const t=Dn(e);for(let e of t)e.startsWith(dn)&&e.search(In)>=0&&-1===e.search($n)&&(e=dn+ ++r+gn),Ln(s,n,e)}}if(a=u.index+i.length,f){s=o.pop()||null;continue}const g=[];let h;for(;null!==(h=En.exec(p));)r=Hn(h,r,e,g);const m={nn:l};g.length&&(m.at=g),s?(s.ch||(s.ch=[]),s.ch.push(m)):n.push(m),d||(o.push(s),s=m)}if(a<t.length){const e=t.slice(a);if(e.trim()){const t=Dn(e);for(const e of t)e.startsWith(dn)&&++r,Ln(s,n,e)}}return n}const On=new RegExp("(\x3c!--[\\s\\S]*?--\x3e)","g");function Ln(t,e,n){!function(t,e,n){t?(t.ch||(t.ch=[]),t.ch.push(n)):e.push(n)}(t,e,{nn:"text",tc:Pn(n)})}function Pn(t){return t.replace(/(\[l t\]!--[\s\S]*?--\[g t\])/g,(function(t){return t.replace(/\[l t\]/g,"<").replace(/\[g t\]/g,">").replace(/\[l&nbsp;t\]/g,"[l t]").replace(/\[g&nbsp;t\]/g,"[g t]")}))}function Dn(t){return t.split(In).filter(jn)}function jn(t){return""!==t}function Hn(t,e,n,o){const s=t[1]||t[3]||t[5];let r=t[2]||t[4]||t[6];if(void 0===s)return e;const a=""!==t[2],c=void 0===r&&a,u=s.toLowerCase(),i=u.startsWith("on")?function(t){if(t.startsWith("on"))return t.length===Sn.length&&t===Sn?"dblclick":t.slice(2,t.length);return t}(u):u;if(c){if(s.slice(0,dn.length)===dn){const t=dn+ ++e+gn;return n.push(["at",t]),o.push([t]),e}if(t[0].startsWith(s)&&t[0].slice(s.length,t[0].length).search(/\s+$/)>=0)return o.push([i]),e;const a=t[3];if(a.search($n)>=0){r=a;const t=[i,r];return o.push(t),e}r=dn+ ++e+gn}a||(r=t[2]);const l=r.split(Un).filter((t=>t.length>0));l.length>1&&(r=l,l.forEach((t=>{t.search(hn)>=0&&++e})));const p=[i,r],f=vt(u);return f&&p.push(f),"style"===i?(o.unshift(p),e):(o.push(p),e)}const Nn=new RegExp(dn+"(\\d+)"+gn,"gi"),Un=new RegExp("("+dn+"\\d+"+gn+")","gi"),Wn=dn.slice(0,dn.length-1),$n=new RegExp(Wn+"&#x72;(\\d+)"+gn,"gi"),Rn=Wn+"&#x72;$1"+gn;function Bn(t,e){const n=function(t,e){const n=t;return function(t,e){const n=[];for(let o=0;o<t.length;++o){const s=t[o].replace(Nn,Rn);o<e.length?n.push(s+dn+o+gn):n.push(s)}return function(t,e,n){const o=n.length-e.length;if(o>0)for(let n=o;n>0;--n)t.push(dn+(e.length+n-1)+gn)}(n,t,e),n}(n,e)}(t,e).join("");return Mn(n)}const Fn="ch";function _n(t,e,n=[],o=[]){const s=t;for(let t=0;t<s.length;t++){const r=[...o,t],a=s[t];if(a.at){const t=a.at;a.at=Gn(t,e)}if(a.ch){const t=a.ch,o=[...r,Fn];a.ch=_n(t,e,n,o)}t=zn(a,e,s,t)}return s}function zn(t,e,n,o){if("text"!==t.nn)return o;const s=t;let r,a=s.tc;if(typeof a!==k.string)return o;for(;null!==(r=hn.exec(a));){const t=r[1],s=parseInt(t,10);if(!isNaN(s)&&s<e){const t=dn+s+gn,e=a.slice(r.index+t.length);n.splice(o,1,{nn:"text",v:s}),a=e,hn.lastIndex=0}}return s.tc=a,o}function Gn(t,e){const n=[];for(const o of t){const[t,s,r]=o;if(t.startsWith(dn)){const o=parseInt(t.replace(dn,""),10);if(!isNaN(o)&&o<e){n.push([{tagJsVar:o}]);continue}}if(typeof s===k.string&&s.startsWith(dn)){const o=parseInt(s.replace(dn,""),10);if(!isNaN(o)&&o<e){n.push([t,{tagJsVar:o},r]);continue}}n.push(o)}return n}function Xn(t){return t.length}const Kn={};function qn(t,e){const n=function(t){const e=t.map(Xn);return e.push(t.length),Number(e.join(""))}(t),o=Kn[n],s=o&&function(t,e,n){if(n&&n.strings.length===t.length&&n.strings.every(((e,n)=>e===t[n]))&&n.values.length===e.length)return!0;return!1}(t,e,o);if(s)return o.domMetaMap;const r=_n(Bn(t,e),e.length),a={interpolation:void 0,string:void 0,strings:t,values:e,domMetaMap:r};return Kn[n]=a,r}function Zn(t,e,n){const o=t.context;o.state=o.state||{};const s=o.state;s.oldest=t,s.newest=t,o.state.older=o.state.newer,++d.locks;const r=function(t,e,n,o){const s=function(t){const e=t.templater,n=e.tag;if(n.tagJsType===S.dom)return n.dom;const o=n.strings;return qn(o,n.values)}(t),r=t.templater.tag,a=r.values,c=[],u=t.context;e=u,u.contexts=c;const i=Jn(s,a,t,e,0,n,o);return i}(t,t.context,e,n);return o.htmlDomMeta=r.dom,--d.locks,r}function Qn(t,e){const n=e.state.newest,o=e.placeholder;return n.ownerSupport=t,Zn(n,void 0,o),n}function Yn(t){const e={tagJsType:S.templater,processInitAttribute:a,processInit:no,processUpdate:a,hasValueChanged:de,destroy:a,propWatch:"shallow",key:a};return e.tag=t,t.templater=e,e}function to(t,e,n){const o=us(t,e,e.appSupport,n);return n.contexts=n.contexts||[],o}function eo(t,e,n,o,s){const r=to(t,n,e);r.ownerSupport=n;const a=Zn(r,o,o?void 0:s);for(const t of a.dom)t.marker&&(o?p.push([y,[o,t.marker]]):u.push([v,[s,t.marker,"subMarker"]])),t.domElement&&(o?p.push([y,[o,t.domElement,"subAppendTo"]]):u.push([v,[s,t.domElement,"subInsertBefore"]]));return r}function no(t,e,n,o,s){return e.state={},s?eo(t,e,n,s,o):Qn(n,e)}function oo(t,e){const n={tagJsType:S.templater,processInit:no,processInitAttribute:a,processUpdate:ht,hasValueChanged:de,destroy:pe,propWatch:t,props:e,key:function(t){return n.arrayValue=t,n},matchesInjection:(t,e)=>n.wrapper===t||n.wrapper?.original===t?.original?e:void 0};return n}const so=[];function ro(t,e,n){const o=t.propWatch===Zo.DEEP?os:ns,s=t.props,r=e.propsConfig;let a=r.castProps;const c=n?.propsConfig,u=c?.castProps;u&&(r.castProps=u,a=Ce(e,n,n.ownerSupport,s,o));return a||ve(s)}function ao(t,e,n){const o=oo(Zo.DEEP);o.tagJsType=t.tagJsType;const s=to(o,n,e);function r(){return o.tag=t(),s}return o.wrapper=r,r.tagJsType=t.tagJsType,r.original=t.original||t,s}function co(t,e,o,s,r){n(e);const a=ao(t,e,o);return Ae(a,void 0,e),eo(a.templater,e,o,r,s)}function uo(t,e,n,o,s){const r=hs(t,e,n,o,s);return r.hasEmitted||io(t,r),r}function io(t,e){const n=t.Observables[0];if(!e.hasEmitted)return"withDefault"in t?void e.subValueHandler(t.withDefault,0):"value"in n?void e.subValueHandler(n.value,0):void 0;const o=e.lastValues[0].value;e.subValueHandler(o,0)}function lo(t,e,n,o,s,r){e.destroy=bs;const a=vt(t),c=function(e,o){Pt(t,e,n,St,a,s),ys(o)},u=ms(e.Observables,r,c,e,s);return s.subContext=u,s.value=e,s.tagJsVar=e,e.processUpdate=function(e,o,r){return Dt(e,s,r,n,t,St)},{subContext:u,onOutput:c}}function po(t,e,n,o,s,r){const{subContext:a}=lo(t,e,n,0,s,r);a.hasEmitted||function(t,e){const n=e.tagJsVar,o=n.onOutput,s=t.Observables;let r=s[0]?.value||t.withDefault;t.callback&&(r=t.callback(r));o(r,!0,e)}(e,a)}function fo(t,e,n){return{onOutput:a,tagJsType:S.subscribe,processInitAttribute:po,processInit:uo,hasValueChanged:go,processUpdate:a,destroy:vs,callback:n,withDefault:e,Observables:[t]}}function go(t,e){if(!t?.tagJsType)return 1;const n=t.Observables;if(!n)return 2;const o=e.value.Observables;if(!o||o.length!==n.length)return 3;return n.every(((t,e)=>t===o[e]))?0:4}function ho(t,e,n,o){if(!e||!e.tagJsType||e.tagJsType!==t){return o.tagJsVar.destroy(o,n),ps(e,o,n,99),99}}function mo(t,e,n){const o=e.subContext,s=ho(S.subscribe,t,n,e);return s||(o&&o.hasEmitted?(o.tagJsVar=t,o.valuesHandler(o.lastValues,0),0):0)}function bo(t,e){return{onOutput:a,tagJsType:S.subscribe,processInitAttribute:lo,processInit:hs,hasValueChanged:go,processUpdate:mo,destroy:vs,callback:e,Observables:[t]}}function vo(t,e){++t.updateCount;const n=yo(t.subContext,e);return delete t.subContext,n}function yo(t,e){t.deleted=!0;const n=t.appendMarker;if(n&&(m(n,"deleteSubContext"),delete t.appendMarker),!t.hasEmitted)return;const o=t.contextItem;return o.tagJsVar.destroy(o,e),76}function xo(t,e,n,o){return e.hasEmitted=!0,e.contextItem=qt(t,n,0,o)}function wo(t,e,n){++e.updateCount;const o=t.owner._innerHTML;o.processInit=o.oldProcessInit;const s=e.subContext?.contextItem;fs(s,o,n)}function Co(t,e,n,o,s){e.subContext={},t.processUpdate=wo,function(t,e,n,o,s){const{appendMarker:r,insertBefore:a}=ds(s,o),c=n.subContext;c.appendMarker=r;const u=t.owner,i=u._innerHTML;i.processInit=i.oldProcessInit,xo(i,c,e,a)}(t,n,e,o,s)}function To(){return{tagJsType:"innerHTML",hasValueChanged:()=>0,processInitAttribute:a,processInit:Co,processUpdate:wo,destroy:vo}}function Vo(t,e){return{onOutput:a,tagJsType:S.subscribe,processInitAttribute:a,hasValueChanged:go,processInit:Jo,processUpdate:a,destroy:vs,callback:e,Observables:t}}function Jo(t,e,n,o,s){return hs({tagJsType:S.subscribe,states:[],Observables:t},e,n,void 0,s)}function ko(t){if(!t)return a;const e=Gs();if(!e)throw new Error("output must be used in render sync with a parent context");const n=H(e);if(!n)throw new Error("output must be used in render sync fashion");if(!0===t.wrapped)return t;const o=(...e)=>{const o=n.ownerSupport;return Io(e,t,o.context)};return o.wrapped=!0,o}function Io(t,e,n){const o=n.state,s=o.newer.states,r=o.older?o.older.states:s,a=o.newest;Re(s,r);const c=e(...t);return Re(r,s),f.push([()=>{const t=a.context.global;if(void 0===t||!0===t.deleted)return++d.locks,a.context.tagJsVar.processUpdate(a.context.value,a.context,a,[]),--d.locks,void h();++d.locks,be(a),--d.locks,h()},[]]),c}function So(t,e={}){const n={tagJsType:S.host,processInitAttribute:Ao,hasValueChanged:()=>0,processInit:Mo,processUpdate:Eo,destroy:Oo,options:{callback:t,...e},matchesInjection(e,n){const o=e?.options;if(!o)return!1;const s=o?.callback;return s===t&&n}},o=(...n)=>({...o,options:{arguments:n,...e,callback:t}});return Object.assign(o,n),o}function Eo(t,e,n){if(P(t)&&!t?.tagJsType)throw new Error("issue on its way");const o=ho(S.host,t,n,e);if(o)return o;const s=e.tagJsVar.options,r=t;var a;Ks(a=e),Se(a.state.newer.state);const c=r.options.arguments||s.arguments||[];e.returnValue=r.options.callback(...c),ke(e)}function Ao(t,e,n,o,s){return Mo(o,s)}function Mo(t,e){const n=e.element,o=e.state={};R(e),function(t,e,n,o){const s=e.options.arguments||[],r=e.options.callback(...s);n.returnValue=r;const a=e.options;a.onInit&&a.onInit(t,e,n,o)}(n,t,e,o),ke(e)}function Oo(t){++t.updateCount;const e=t,n=e.tagJsVar,o=n.options;if(e.destroy$.subscribers.length&&(Ks(t),Io([],e.destroy$.next.bind(e.destroy$),t),qs()),o.onDestroy){const s=e.element;return Io([],(function(){Ks(t);const r=o.onDestroy(s,n,e,e.state);return qs(),r}),t.stateOwner.context)}}function Lo(t,e,n,o){const s={tagJsType:"tag-conversion",processInitAttribute:a,processInit:(s,r,a)=>{const c=t.returnValue;return e.tagJsVar.processInit(c,e,n,o.placeholder)},processUpdate:(t,o,r)=>{if(o.locked||o.deleted)return;++o.updateCount;const a=o.value.tagJsType,c=t?.tagJsType,u=c!==a;if(fe(t,o)||u||s.hasValueChanged(t,o,n))return s.destroy(o,n),void ps(t,o,r,789);o.locked=467,o.render$.next();const i=o.returnValue;!function(t,e,n,o,s){const r=ve(e.props);t.value.props=r;const a=s.propsConfig;a&&(a.castProps=r);if(t.updatesHandler=n.updatesHandler,n.updatesHandler){Ks(n);(0,n.updatesHandler)(r),qs()}t.tagJsVar.processUpdate(o,t,s,[]),t.value=o}(e,t,o,i,n),delete o.locked},hasValueChanged:(n,o,s)=>{const r=t.returnValue;return e.tagJsVar.hasValueChanged(r,e,s)},destroy:(o,s)=>{++t.updateCount,t.deleted=!0,delete t.returnValue;const r=e.tagJsVar.destroy(e,n);return L(r)?r.then((()=>{const e=Ho(t,s);return h(),e})):Ho(t,s)}};return s}function Po(t,e,n){const o=t.context,s=t.returnValue,r=Xt(s);delete o.global,o.contexts=[];const a={updateCount:0,value:s,tagJsVar:r,destroy$:new q,render$:new q,placeholder:o.placeholder,valueIndex:-1,withinOwnerElement:!0,parentContext:o,contexts:o.contexts},c=Lo(o,a,t,n);return o.tagJsVar=c,r.processInit(s,a,t,n.placeholder),t}function Do(t,e,n){const o=is(t,e,n,n?.appSupport),s=o.propsConfig;if(s){const e=t.tagJsType!==S.tagComponent?[]:ro(t,o);s.castProps=e}return Ae(o,e.state.newest,e)}function jo(t,e,n){const o=Do(t,e,n),s=o.templater.tag;return["dom","html"].includes(s.tagJsType)?(Zn(o,void 0,e.placeholder),o):Po(o,o.ownerSupport,e)}function Ho(t,e){delete t.returnValue,delete t.global,t.contexts=[],t.htmlDomMeta=[],delete t.updatesHandler}function No(t,e,n,o){const s=Do(t,e,n),r=s.templater.tag;return["dom","html"].includes(r.tagJsType)?function(t,e){const n=Zn(t,e,void 0);for(const t of n.dom)t.domElement&&p.push([y,[e,t.domElement]]),t.marker&&p.push([y,[e,t.marker]]);return t}(s,o):Po(s,0,e)}function Uo(t,e,o,s,r){return n(e),r?No(t,e,o,r):jo(t,e,o)}function Wo(t){return tt.stateConfig.handlers.handler(t)}function $o(t){return Wo((()=>{const e=t();if(Gs().global){return Qe(e,s(),{resolvePromise:Ro,resolveValue:Bo})}})),Qo}function Ro(t){return t}function Bo(t){return t}function Fo(t){return Wo((function(){Gs().destroy$.toCallback(t)})),Qo}bo.all=function(t,e){return bo(q.all(t),e)},So.onInit=t=>So((()=>{}),{onInit:t}),So.onDestroy=t=>So((()=>{}),{onDestroy:t});let _o=0;const zo=Xo("click"),Go=Xo("mousedown");function Xo(t){return function(e){const n=$s(e);return Wo((()=>{Xs().addEventListener(t,n)})),n}}const Ko={get:Xs,onclick:zo,click:zo,onClick:zo,mousedown:Go,onmousedown:Go,onMouseDown:Go};function qo(t,e){Object.defineProperty(Qo,t,{get:()=>e,set:t=>e(t)})}var Zo;function Qo(t,e=Zo.SHALLOW){const n=function(...o){const s=oo(e,o);s.tagJsType=S.tagComponent,s.processInit=Uo,s.hasValueChanged=de;const r=function(t,e){return function(n,o,s){const r=ro(t,n,s),a=n.ownerSupport,c=is(t,o,a,n.appSupport,r);return Je(t,e,c,r)}}(s,n);return r.original=t,s.wrapper=r,s},o=t;n.original=t,o.tags=so,o.setUse=tt,o.ValueTypes=S,o.tagIndex=_o++,so.push(n);const s=n;return s.updates=t=>(Gs().updatesHandler=t,!0),s.getInnerHTML=To,s}function Yo(t,e,n){if(Ne(t,e))return 11;switch(n){case Zo.NONE:return 1;case Zo.SHALLOW:return it(t,e);case Zo.IMMUTABLE:return es(t,e)}return function(t,e){let n=t,o=e;n=[...t],o=[...e||[]];if(!n.every(((t,e)=>function(t,e,n,o){const s=o[e];if(typeof t===I.object){const e={...t},n={...s||{}},o=Object.entries(e).every((([t,o])=>ts(o,n[t],(()=>{delete e[t],delete n[t]}))));return o}return ts(t,s,(function(){n.splice(e,1),o.splice(e,1)}))}(t,e,n,o))))return 7;return!1}(t,e)}function ts(t,e,n){if(typeof t!==I.function)return!!rt(t,e,os)&&4;if(typeof e!==I.function)return!1;const o=e?.original;o&&(e=o);t.original&&(t=t.original);return t.toString()===e.toString()?(n(),5):(n(),6)}function es(t,e){const n=t.length;for(let o=0;o<n;++o){if(t[o]!==e[o])return 2}return!1}qo("onclick",zo),qo("click",zo),qo("onMouseDown",Go),qo("onmousedown",Go),qo("mousedown",Go),function(t){t.DEEP="deep",t.SHALLOW="shallow",t.NONE="none",t.IMMUTABLE="immutable"}(Zo||(Zo={})),Qo.element=Ko,Qo.renderOnce=function(){throw new Error("Do not call tag.renderOnce as a function but instead set it as: `(props) => tag.renderOnce = () => html`` `")},Qo.use=function(){throw new Error("Do not call tag.use as a function but instead set it as: `(props) => tag.use = (use) => html`` `")},Qo.deepPropWatch=Qo,Qo.route=function(t){throw new Error("Do not call tag.route as a function but instead set it as: `tag.route = (routeProps: RouteProps) => (state) => html`` `")},Qo.inject=function(t){const e=Gs();if(!e)throw new Error("tag.inject can only be called within a tag or host context");let n=e.parentContext;for(;n;){const e=n.contexts;if(e)for(const n of e)if(n.isAttr&&n.tagJsVar?.matchesInjection){const e=n.tagJsVar.matchesInjection(t,n);if(void 0!==e)return e.returnValue}if(n.tagJsVar?.matchesInjection&&n.tagJsVar.matchesInjection(t,n))return n.returnValue;n=n.parentContext}const o=`Could not find parent context for tag.inject ${t}`;throw console.error(o,{targetItem:t,context:e}),new Error(o)},Qo.onInit=$o,Qo.onDestroy=Fo,Qo.onRender=function(t){const e=Gs(),n=n=>{const o=Gs();Ks(e);const s=t();return qs(),Ks(o),s},o=e.render$.subscribe((()=>n())),s=n();return Qo.onDestroy((()=>o.unsubscribe())),s},Qo.getInnerHTML=To,Qo.app=function(t){throw new Error("Do not call tag.route as a function but instead set it as: `tag.route = (routeProps: RouteProps) => (state) => html`` `")},Qo.immutableProps=function(t){return Qo(t,Zo.IMMUTABLE)},Qo.watchProps=function(t){return Qo(t,Zo.SHALLOW)},Object.defineProperty(Qo,"renderOnce",{set(t){t.tagJsType=S.renderOnce,t.processInit=co,t.processUpdate=ht,t.destroy=pe,t.hasValueChanged=function(){return 0}}}),Object.defineProperty(Qo,"use",{set(t){t.original={setUse:tt,tags:so},t.tagJsType=S.stateRender,t.processInit=Uo,t.processUpdate=ht,t.hasValueChanged=de,t.destroy=pe}});const ns=3,os=10;function ss(t){return ut(t,ns)}function rs(t){return ut(t,os)}function as(t,e,n){const o={templater:t,context:e,castedProps:n,appSupport:void 0};return e.global.blocked=[],e.state||(e.state={newer:{state:[],states:[]}}),o}function cs(t,e,n,o){e.appSupport=n||e;const s=t.props;return s&&(e.propsConfig=function(t,e,n){const o=t.templater;if(o.tagJsType!==S.stateRender){switch(o.propWatch){case Zo.IMMUTABLE:return t.propsConfig={latest:e,castProps:n};case Zo.SHALLOW:return t.propsConfig={latest:e.map(ss),castProps:n}}return t.propsConfig={latest:e.map(rs),castProps:n}}}(e,s,o)),e}function us(t,e,n,o,s){const r={templater:t,context:o,castedProps:s,appSupport:void 0};return r.ownerSupport=e,r.appSupport=n,r}function is(t,e,n,o,s){const r=as(t,e,s);return r.ownerSupport=n||r,r.ownerSupport.appSupport=o||r.ownerSupport,cs(t,r,o,s)}function ls(t,e,o){if(M(e))return void 0===t.global&&n(t),t.oldTagJsVar=t.tagJsVar,t.tagJsVar=e,function(t,e,n){if(!e.state.newest)return void t.processInit(t,e,n,e.placeholder);const o=is(t,e,n,n.appSupport);we(n,o,e)}(e,t,o),!0;if(t.global){t.oldTagJsVar=t.tagJsVar,t.tagJsVar=e;const n=t.state.newest;if(n)return typeof e===I.function||function(t,e,n,o){let s=n.templater||n;const r=t.templater.tag;r&&r._innerHTML&&(s=n.outerHTML||n._innerHTML.outerHTML);const a=is(s,e,o,o.appSupport);nt(t.context.state.oldest,a)}(n,t,e,o),!0}return e.processInit(e,t,o,t.placeholder),t.oldTagJsVar=t.tagJsVar,t.tagJsVar=e,!0}function ps(t,e,n,o){const s=t&&t.tagJsType;if(delete e.deleted,s){if(s===S.renderOnce)return;ls(e,t,n)}else{if(j(t))return Zt(e,t,n),e.oldTagJsVar=e.tagJsVar,void(e.tagJsVar=_t(t));typeof t!==I.function?o&&function(t,e){e.value=t,e.oldTagJsVar=e.tagJsVar,e.tagJsVar=Nt(t);const n=e.placeholder,o=bt(t),s=e.paint=[C,[n,o,function(t){e.simpleValueElm=t,delete e.paint},"processNowRegularValue"]];u.push(s)}(t,e):e.value=t}}function fs(t,e,n){const o=t.tagJsVar.hasValueChanged(e,t,n);return 0===o||ps(e,t,n,o),o}function ds(t,e){let n;return t&&(n=e=document.createTextNode(J),p.push([y,[t,e]])),{appendMarker:n,insertBefore:e}}function gs(t,e,n){const o=mo(t,e,n);if(!0!==e.hasEmitted){const t=e.value.Observables;if(!t)return;if(!("value"in t[0]))return}if(0===o&&t.callback){io(t,e.subContext)}}function hs(t,e,n,o,s){const r=t.Observables,{appendMarker:a,insertBefore:c}=ds(s,o);let u=function(t,e,o){xo(t,o,n,c),ys(e),u=o.tagJsVar.onOutput=function(t,e,o){const s=o.contextItem;fs(s,t,n),s.tagJsVar.processUpdate(t,s,n,[t]),s.value=t,ys(e)}};const i=ms(r,n,((t,e,n)=>u(t,e,n)),t,e);return i.appendMarker=a,e.subContext=i,t.processUpdate=gs,t.onOutput=u,i}function ms(t,e,n,o,s){function r(t,e){u.lastValues[e]={value:t,tagJsVar:Xt(t),oldTagJsVar:u.lastValues[e]?.tagJsVar},a(u.lastValues,e)}function a(t,e){const o=u.tagJsVar,r=o?.callback;if(r){Ks(s);const e=o.callback(...t.map((t=>t.value)));return n(e,c,u),void qs()}const a=t[e].value;n(a,c,u)}let c=!0;const u={lastValues:[],subValueHandler:r,valuesHandler:a,tagJsVar:o,subscriptions:[]};return t.forEach(((t,e)=>{c=!0,u.subscriptions.push(t.subscribe((t=>r(t,e)))),c=!1})),o.onOutput=n,u}function bs(t){const e=t.subContext;if(!e)return;e.subscriptions.forEach((t=>t.unsubscribe())),delete t.subContext}function vs(t,e){++t.updateCount;const n=t.subContext;return bs(t),yo(n,e)}function ys(t){t||tt.stateConfig.support||h()}function xs(t,e,n,o,s){hs({tagJsType:S.subscribe,states:[],Observables:[t]},e,n,o,s)}function ws(t){return s()?Wo((()=>Cs(t))):Cs(t)}function Cs(t){let e=t;const n=new Set,o=t=>{n.forEach((e=>e(t)))};return{tagJsType:S.signal,hasValueChanged:go,processInitAttribute:a,processInit:xs,processUpdate:gs,get value(){return e},set value(t){e!==t&&(e=t,o(t))},destroy:vs,emit:o,subscribe(t){t(e),n.add(t);const o=()=>n.delete(t);return o.unsubscribe=o,o}}}class Ts extends q{value;constructor(t){super(t),this.value=t}subscribe(t){const e=super.subscribe(t);return t(this.value,e),e}}class Vs extends q{value;constructor(t){super(t),this.value=t,this._value=t,Q(this)}subscribe(t){const e=super.subscribe(t);return t(this._value,e),e}}function Js(t){return(e,n)=>{n.setHandler((()=>{})),t(e,n.next)}}function ks(t){return(e,n)=>{n.setHandler((()=>{}));t(e).then((t=>n.next(t)))}}const Is=t=>(e,n)=>{n.setHandler((()=>{}));const o=t(e).subscribe((t=>{o.unsubscribe(),n.next(t)}))},Ss=(t,e)=>As(t,e).pastResult,Es=t=>t;const As=(t,e,{init:n,before:o,final:s=Es}={})=>{const r=Wo({pastResult:void 0,values:void 0}),a="function"==typeof t?t():t,c=void 0===r.values;let u=0;function i(t){if(void 0===r.values){if(o&&!o(t))return r.values=t,r;const a=(n||e)(t,r.values);return r.pastResult=s(a),r.values=t,r}if(t.every(((t,e)=>t===r.values[e])))return r;if(o&&!o(t))return r.values=t,r;const a=e(t,r.values);return r.pastResult=s(a),r.values.length=0,r.values.push(...t),r}return c&&"function"==typeof t&&Qo.onRender((()=>{if(++u,1===u)return;i(t())})),i(a)};function Ms(t,e){return Object.defineProperty(e,"noInit",{get(){const e=t();return e.setup.init=()=>{},e}}),Object.defineProperty(e,"asSubject",{get(){const e=t(),n=Wo((()=>s())),o=Wo((()=>new Ts(void 0))),r=Wo((()=>({state:tt.stateConfig.state,states:tt.stateConfig.states}))),a=(t,a)=>(As(t,((t,e)=>{const c=s(),u=a(t,e);if(c!==n){const t=r.state,e=n.context.state.older;if(e){Ge(t,e.state,r.states,e.states)}}o.next(u)}),e.setup),o);return a.setup=e.setup,Ms((()=>a),a),a}}),Object.defineProperty(e,"truthy",{get(){const e=t();return e.setup.before=t=>t.every((t=>t)),e}}),e}function Os(t){return s()?Wo((()=>new q(t))):new q(t)}function Ls(t){return tt.stateConfig.handlers.statesHandler(t)}function Ps(t){const e=ws([]),n=ws(0),o=ws(0);let s=[],r=0;return o.value=n.value,t(((...t)=>(s=t,e.value))),Ss(s,(()=>{++r,e.value=s,t((()=>s))})),Ls(((s,a)=>{if(r)return t(((...t)=>(a&&1!==a||(e.value=t),e.value))),o.value=n.value,void++n.value;t((()=>e.value))})),++r,e.value}function Ds(){return{stateDiff:0,provider:void 0}}Ms((()=>function(t){const e=(e,n)=>As(e,n,t).pastResult;return e.setup=t,Ms((()=>e),e),e}({})),Ss),Os._value=t=>{const e=Wo((function(){return{state:tt.stateConfig.state,states:tt.stateConfig.states}})),n=s();return Wo((function(){return new Ts(t).pipe((t=>{const o=n.context.state.newer;return Ge(o.state,e.state,o.states,e.states),t}))}))},Os.all=function(t){const e=Wo((()=>({state:tt.stateConfig.state,states:tt.stateConfig.states}))),n=s();return q.all(t).pipe((t=>{const o=n.context.state.newer;return o&&Ge(o.state,e.state,o.states,e.states),t}))};const js={create:t=>{const e=Wo(Ds);if(e.stateDiff){let t=e.stateDiff;for(;t--;)Wo(void 0);return Wo(void 0)}const n=Wo((()=>{const n=tt.stateConfig,o=n.state.length,s=t.prototype?new t:t(),r=n.support,a=n.state.length-o,c={constructMethod:t,instance:s,stateDiff:a,owner:r,children:[]};e.provider=c;const u=r.context;return(u.providers=u.providers||[]).push(c),e.stateDiff=a,s})),o=t,s=o.compareTo=o.toString();return e.provider.constructMethod.compareTo=s,n},inject:function(t){return Wo((function(){const e=t,n=e.compareTo=e.compareTo||t.toString(),o=s(),r=[];let a={ownerSupport:o.ownerSupport};for(;a.ownerSupport;){const t=a.ownerSupport.context.providers;if(!t){a=a.ownerSupport;continue}const e=t.find((t=>{r.push(t);if(t.constructMethod.compareTo===n)return!0}));if(e){const t=o.context;return(t.providers=t.providers||[]).push(e),e.children.push(o),e.instance}a=a.ownerSupport}const c=`Could not inject provider: ${t.name} ${t}`;throw console.warn(`${c}. Available providers`,r),new Error(c)}))}};class Hs extends Error{details;constructor(t,e,n={}){super(t),this.name=Hs.name,this.details={...n,errorCode:e}}}class Ns extends Hs{constructor(t,e){super(t,"array-no-key-error",e),this.name=Ns.name}}class Us extends Hs{constructor(t,e){super(t,"state-mismatch-error",e),this.name=Us.name}}class Ws extends Hs{constructor(t,e){super(t,"sync-callback-error",e),this.name=Ws.name}}function $s(t){const e=Gs(),n=Wo({callback:t}),o=Wo((()=>Rs(e,tt.stateConfig,n)));return n.callback=t,o}function Rs(t,e,n){const o=e.states;return function(...e){const s=function(t,e,n,...o){const s=n(...o),r=H(t);if(!r)return s;if(r.context.global)De(r);else{const t=r.context;t.tagJsVar.processUpdate(t.value,t,r.ownerSupport,[])}return L(s)&&s.finally((()=>{if(t.global)De(r);else{const t=r.context;t.tagJsVar.processUpdate(t.value,t,r.ownerSupport,[])}})),s}(t,o,n.callback,...e);return h(),s}}const Bs=()=>{const t=Gs();if(!t)throw Fs;const e=tt.stateConfig;return function(n){return Rs(t,e,{callback:n})}},Fs=new Ws("callback() was called outside of synchronous rendering. Use `callback = callbackMaker()` to create a callback that could be called out of sync with rendering");function _s(t=[]){return s()?Wo((()=>zs(Cs(t)))):zs(Cs(t))}function zs(t){const e=["push","pop","splice","shift","unshift"],n=["map","reduce","forEach","every"],o=new Proxy(t,{get(s,r){return isNaN(r)?"length"===r?t.value.length:e.includes(r)?o[a=r]=(...e)=>{const n=t.value[a](...e);return t.emit(t.value),n}:n.includes(r)?t.value[r].bind(t.value):t[r]:t.value[r];var a},set:(e,n,o)=>isNaN(n)?"length"===n?(t.value.length=o,t.emit(t.value),!0):(t[n]=o,!0):(t.value[n]=o,t.emit(t.value),!0)});return o}function Gs(){return tt.stateConfig.context}function Xs(){return Gs().element}function Ks(t){return tt.stateConfig.context=t}function qs(){delete tt.stateConfig.context}function Zs(t,e,o,s,r){const a=t;let c=a.templater;if(c||(c=Yn(a)),n(e),r)return eo(c,e,o,r,s);return(e.state=e.state||{}).newest=to(c,o,e),Qn(o,e)}function Qs(t,e,n,o,s){Zs(t.outerHTML,e,n,o,s);e.tagJsVar.processUpdate=function(t,e,n){fs(e,t?.outerHTML||t,n)},t.hasValueChanged=Ys}function Ys(t,e){return de(t,e)}function tr(t,e){const n={values:e,ownerSupport:s(),tagJsType:S.tag,processInitAttribute:a,processInit:Zs,processUpdate:ht,hasValueChanged:de,destroy:pe,strings:t,key:t=>er(t,n),setHTML:function(t){return t.outerHTML=n,n._innerHTML=t,t.oldProcessInit=t.processInit,t.processInit=Qs,n},acceptInnerHTML:function(t){return t.owner=n,n},html:function(t,e){return n.children={strings:t,values:e},n}};return Object.defineProperty(n,"innerHTML",{set:t=>n.setHTML(t)}),n}function er(t,e){return er(t,e),e.arrayValue=t,e}function nr(t,e){const n={values:e,ownerSupport:s(),dom:t,tagJsType:S.dom,processInitAttribute:a,processInit:Zs,processUpdate:ht,hasValueChanged:de,destroy:pe,key:function(t){return n.arrayValue=t,n},setHTML:function(t){return t.outerHTML=n,n._innerHTML=t,t.oldProcessInit=t.processInit,t.processInit=Qs,n},acceptInnerHTML:function(t){return t.owner=n,n},html:{dom:function(t,e){return n.children={dom:t,values:e},n}}};return Object.defineProperty(n,"innerHTML",{set:t=>n.setHTML(t)}),n}function or(t,...e){const n=tr(t,e),o=oo(Zo.NONE);return o.tag=n,n.templater=o,n}or.dom=function(t,...e){return nr(t,e)},"object"==typeof document&&(document.taggedJs&&console.warn(" Multiple versions of taggedjs are loaded. May cause issues."),document.taggedJs=!0);const sr=[];function rr(t,e,o){const s=sr.findIndex((t=>t.element===e));if(s>=0){const t=sr[s].support;ue(t,t.context.global),sr.splice(s,1),console.warn("Found and destroyed app element already rendered to element",{element:e})}let c=()=>p(o);c.propWatch=Zo.NONE,c.tagJsType=S.stateRender,c.processUpdate=ht,c.props=[o],c.isApp=!0;const u=function(t,e){const o={tagJsType:"templater",hasValueChanged:de,destroy:pe,processInitAttribute:a,processInit:function(){console.debug("do nothing app function")},processUpdate:ht},s={updateCount:0,value:t,valueIndex:0,varCounter:0,destroy$:new q,render$:new q,withinOwnerElement:!1,renderCount:0,global:void 0,state:{},tagJsVar:o};return n(s),s.events={},function(t,e,n){const o=as(t,e);cs(t,o,o),o.appElement=n,e.state.oldest||(e.state.oldest=o,e.state.older=e.state.newer),e.state.newest=o}(t,s,e),s}(c,e),i=u.global,l=u.state.newest;R(l.context),r(l);let p=t(o);const f=typeof p==I.function;f||(M(p)?(u.state.newest.propsConfig={latest:[o],castProps:[o]},c.propWatch=p.propWatch,c.tagJsType=p.tagJsType,c.wrapper=p.wrapper,c=p):(c.tag=p,p=t));const g=function(t,e,n,o,s,r,a){const c=document.createTextNode(J);if(so.push(n.wrapper||{original:n}),r.placeholder=c,e.isApp=!0,!s)throw new Error(`Cannot tagElement, element received is type ${typeof s} and not type Element`);s.destroy=function(){const t=r.events;for(const e in t){const n=t[e];s.removeEventListener(e,n)}r.events={},++d.locks;const n=ue(i,e);return--d.locks,h(),n},++d.locks;const u=document.createDocumentFragment();u.appendChild(c);const i=jo(n,r,{appSupport:{appElement:s,context:r},appElement:s});return i.appElement=s,a&&(o.tag=i.templater.tag),--d.locks,h(),s.appendChild(u),{support:i,tags:so,ValueTypes:S}}(0,i,c,p,e,u,f);return qs(),g}function ar(t,e,n){function o(t){return o.toCallback(t)}return o.toCallback=n,t.listeners.push([e,o]),t.allListeners.push([e,o]),t}function cr(t,e){return t.attributes.push(e),lr(e[0])?ir(e[0],t):lr(e[1])&&ir(e[1],t),t}function ur(t){function e(e){return function(n){return function(t,e,n){return ar(Jr(t,t.elementFunctions),e,n)}(t,e,n)}}const n={onClose:e("onclose"),onDoubleClick:e("ondblclick"),onClick:e("click"),onBlur:e("onblur"),onChange:e("onchange"),onMousedown:e("onmousedown"),onMouseup:e("onmouseup"),onKeydown:e("onkeydown"),onKeyup:e("onkeyup"),attr:(...e)=>function(t,e){const n=Jr(t,t.elementFunctions);return n.attributes.push(e),lr(e[0])?ir(e[0],n):lr(e[1])&&ir(e[1],n),n}(t,e),key:function(t){return this.arrayValue=t,this}};return n}function ir(t,e){e.contexts||(e.contexts=[]),e.contexts.push(t)}function lr(t){return Array.isArray(t)||P(t)||t?.tagJsType}function pr(t,e){return(n,o)=>cr(n,[t,o,!1,e])}function fr(t){return(e,n)=>ar(e,t,n)}const dr={onClose:fr("onclose"),onClick:fr("click"),onDoubleClick:fr("ondblclick"),onDblClick:fr("ondblclick"),onBlur:fr("onblur"),onChange:fr("onchange"),onMousedown:fr("onmousedown"),onMouseDown:fr("onmousedown"),onMouseup:fr("onmouseup"),onMouseUp:fr("onmouseup"),onKeyup:fr("onkeyup"),onKeyUp:fr("onkeyup"),onKeydown:fr("onkeydown"),onKeyDown:fr("onkeydown")},gr={checked:pr("checked",Et),selected:pr("selected",Et),class:pr("class",(function(t,e,n){D(n)?Object.entries(n).forEach((([e,n])=>{n?t.classList.add(e):t.classList.remove(e)})):At(t,e,n)})),...dr};function hr(t,e){++t.updateCount;const n=t.contexts,o=[];if(n.length&&(mr(n,e,o),n.length=0,o.length)){const e=t.htmlDomMeta;return t.deleted=!0,Promise.all(o).then((()=>{++d.locks,se(e),t.htmlDomMeta=[],--d.locks,h()}))}ce(t),t.htmlDomMeta=[],delete t.contexts,t.deleted=!0}function mr(t,e,n){const o=t[0],s=o.tagJsVar.destroy(o,e);return o.deleted=!0,L(s)?n.push(s.then((()=>{if(t.length>1)return mr(t.slice(1,t.length),e,n)}))):(o.htmlDomMeta&&(ce(o),delete o.htmlDomMeta),t.length>1?mr(t.slice(1,t.length),e,n):void 0)}function br(t,e,n){if(e.locked||!0===e.deleted)return;++e.updateCount;if(vr(t,e))return hr(e,n),e.htmlDomMeta=[],delete e.deleted,void ps(t,e,n,789);const o=e.contexts,s=t.contexts||[],r=e.tagJsVar.allListeners;if(t.allListeners.forEach(((t,e)=>{r[e][1].toCallback=t[1].toCallback})),o.length!==s.length)throw console.info("context mismatch",{value:t,context:e,conValues:o.map((t=>t.value)),vContexts:s,deleted:e.deleted}),new Error("super issue discovered");e.locked=79,o.forEach(((t,e)=>{t.tagJsVar.processUpdate(s[e],t,n)})),delete e.locked}function vr(t,e){if(e.value===t)return 0;if(!t||"element"!==t.tagJsType)return 1;if(t.innerHTML.length!==e.value.innerHTML.length)return 1;return t.attributes.length!==e.value.attributes.length?1:0}function yr(t,e,n,o,s){t.forEach((t=>{switch(typeof t){case"string":case"boolean":case"number":return wr(t,o,s);case"function":{if("element"===t.tagJsType)break;const r=function(t,e,n,o,s){const r=[],c={updateCount:0,parentContext:n,contexts:r,element:e,value:t,htmlDomMeta:[],tagJsVar:{tagJsType:"dynamic-text",hasValueChanged:()=>0,processInit:a,processInitAttribute:a,destroy:(t,e)=>{++c.updateCount,r.forEach((t=>t.tagJsVar.destroy(t,e)))},processUpdate:(t,e,n,o)=>{++c.updateCount,Ks(i);let s=t(i);const r=c.underFunction;delete c.underFunction,s instanceof Function&&!s.tagJsType&&(r&&s.toString()===r.toString()?s=i.value:(c.underFunction=s,s=s()));const a=i.tagJsVar.processUpdate(s,i,n,o);return i.value=s,e.value=t,qs(),a}},valueIndex:-1,withinOwnerElement:!0,destroy$:new q,render$:new q};Ks(c);let u=t();P(u)&&!u.tagJsType&&(c.underFunction=u,u=u());const i=xr(u,c,e,o,s);return n.contexts.push(c),qs(),i}(t,o,e,n,s);return r}}if(null==t)return wr(t,o,s);if("element"!==t.tagJsType)return xr(t,e,o,n,s);{const r=Cr(t,e,n,e.contexts);u.push([s,[o,r]]);e.htmlDomMeta.push({nn:r.tagName,domElement:r,at:[]})}}))}function xr(t,e,n,o,s){const r=Kt(t,0,!0,e);return e.contexts.push(r),r.element=n,r.placeholder=document.createTextNode(""),u.push([s,[n,r.placeholder]]),Ks(r),r.tagJsVar.processInit(t,r,o,r.placeholder),qs(),r}function wr(t,e,n){const o=bt(t),s=document.createTextNode(o);return u.push([n,[e,s]]),s}function Cr(t,e,n,o){const s=document.createElement(t.tagName);return e.element=s,t.attributes.forEach((t=>{const e=t[0];"string"==typeof e&&(t[2]=vt(e))})),Tn(t.attributes,[],s,n,e),yr(t.innerHTML,e,n,s,y),t.listeners.forEach(((e,o)=>function(t,e,n,o,s){const r=(...o)=>{const s=t.listeners[e][1],r=N(n),a=r.context.updateCount;r.context.locked=1,++d.locks;const c=s(...o);--d.locks,delete r.context.locked;return a===r.context.updateCount?tn(c,r):(h(),L(c)?c.then((()=>(We([r.context.state.newest]),"promise-no-data-ever"))):"no-data-ever")};an(n.appSupport,o[0],s,r)}(t,o,n,e,s))),s}function Tr(t,e,n,o){e.contexts=e.contexts||[],e.htmlDomMeta=[],e.locked=34;const s=Cr(t,e,n,e.contexts);delete e.locked,u.push([v,[o,s,"htmlTag.processInit"]]);const r={nn:t.tagName,domElement:s,at:t.attributes};return e.htmlDomMeta=[r],s}function Vr(t){const e=Jr({tagJsType:"element",processInitAttribute:a,processInit:Tr,destroy:hr,processUpdate:br,hasValueChanged:vr,tagName:t,innerHTML:[],attributes:[],listeners:[],allListeners:[],elementFunctions:ur},ur);return e.tagName=t,e}function Jr(t,e){const n=(...t)=>{const e={...n};var o,s;return e.attributes=[...n.attributes],e.listeners=[...n.listeners],e.allListeners=[...n.allListeners],t.length>0&&"object"==typeof t[0]&&!Array.isArray(t[0])&&!t[0].tagJsType&&(o=e,s=t[0],Object.entries(s).reduce(((t,[e,n])=>e in gr?gr[e](o,n):cr(o,[e,n,!1,St])),o),t.splice(0,1)),e.innerHTML=t,t.forEach((t=>{if(lr(t))return"element"===t.tagJsType?(e.allListeners.push(...t.allListeners),void(t.contexts&&(e.contexts?e.contexts.push(...t.contexts):e.contexts=t.contexts))):void function(t,e){e.contexts||(e.contexts=[]);e.contexts.push(t)}(t,e)})),e};return Object.assign(n,t),Object.assign(n,ur(n)),n.attributes=[...t.attributes],n.listeners=[...t.listeners],n.allListeners=[...t.allListeners],n}const kr=function(){const t=Jr({tagJsType:"element",processInitAttribute:a,processInit:Ir,destroy:Sr,processUpdate:br,hasValueChanged:vr,tagName:"no-element",innerHTML:[],attributes:[],listeners:[],allListeners:[],elementFunctions:ur});return t.tagName="no-element",t}();function Ir(t,e,n,o){e.contexts=e.contexts||[],e.htmlDomMeta=[],yr(t.innerHTML,e,n,o,v)}function Sr(t,e){++t.updateCount;const n=t.contexts,o=[];if(n.length&&(mr(n,e,o),n.length=0,o.length)){const e=t.htmlDomMeta;return Promise.all(o).then((()=>{++d.locks,se(e),--d.locks,h()}))}}const Er=Vr("button"),Ar=Vr("select"),Mr=Vr("option"),Or=Vr("input"),Lr=Vr("textarea"),Pr=Vr("html"),Dr=Vr("head"),jr=Vr("title"),Hr=Vr("meta"),Nr=Vr("link"),Ur=Vr("style"),Wr=Vr("body"),$r=Vr("noscript"),Rr=Vr("hr"),Br=Vr("h1"),Fr=Vr("h2"),_r=Vr("h3"),zr=Vr("h4"),Gr=Vr("h5"),Xr=Vr("h6"),Kr=Vr("ol"),qr=Vr("ul"),Zr=Vr("li"),Qr=Vr("div"),Yr=Vr("main"),ta=Vr("section"),ea=Vr("header"),na=Vr("footer"),oa=Vr("fieldset"),sa=Vr("legend"),ra=Vr("dialog"),aa=Vr("pre"),ca=Vr("table"),ua=Vr("tr"),ia=Vr("td"),la=Vr("th"),pa=Vr("thead"),fa=Vr("tbody"),da=Vr("tfoot"),ga=Vr("a"),ha=Vr("br"),ma=Vr("label"),ba=Vr("p"),va=Vr("small"),ya=Vr("span"),xa=Vr("strong"),wa=Vr("b"),Ca=Vr("sup"),Ta={tagElement:rr,renderWithSupport:Oe,renderSupport:De,firstTagRender:Ae,reRenderTag:Ee,paint:h};var Va=e.W9,Ja=e.cg,ka=e.m0,Ia=e.rS,Sa=e.Y2,Ea=e.ei,Aa=e.B7,Ma=e.TU,Oa=e.XF,La=e.PC,Pa=e.Ot,Da=e.Mj,ja=e.tD,Ha=e.a,Na=e.Gf,Ua=e.xe,Wa=e.YO,$a=e.b,Ra=e.rf,Ba=e.br,Fa=e.um,_a=e.x6,za=e.E2,Ga=e.OH,Xa=e.TB,Ka=e.Ii,qa=e.mX,Za=e.yV,Qa=e.EI,Ya=e.zV,tc=e.pf,ec=e.ze,nc=e.Go,oc=e.bD,sc=e.WJ,rc=e.wL,ac=e.Ng,cc=e.O,uc=e.r3,ic=e.y4,lc=e.Ie,pc=e.lI,fc=e.hp,dc=e.qr,gc=e.ts,hc=e.B4,mc=e.HD,bc=e.Az,vc=e.Xi,yc=e.sV,xc=e.Ah,wc=e.f5,Cc=e.Gk,Tc=e.j_,Vc=e.h1,Jc=e.h2,kc=e.h3,Ic=e.h4,Sc=e.h5,Ec=e.h6,Ac=e.zC,Mc=e.d5,Oc=e.wx,Lc=e.cF,Pc=e.Hc,Dc=e.PB,jc=e.uq,Hc=e.hr,Nc=e.qy,Uc=e.gM,Wc=e.gx,$c=e.hF,Rc=e.cy,Bc=e.Tn,Fc=e.Gv,_c=e.yL,zc=e.D8,Gc=e.Ze,Xc=e._4,Kc=e.mn,qc=e.Pf,Zc=e.o1,Qc=e.z,Yc=e.li,tu=e.nf,eu=e.iW,nu=e.mI,ou=e.et,su=e.Vg,ru=e.ol,au=e.sA,cu=e.TG,uu=e.MG,iu=e.PL,lu=e.uK,pu=e.CG,fu=e.p,du=e.nI,gu=e.Fs,hu=e.AS,mu=e.r5,bu=e.M$,vu=e.uc,yu=e.QB,xu=e.uW,wu=e.Lt,Cu=e.Jv,Tu=e.TA,Vu=e.Jn,Ju=e.Ll,ku=e.vP,Iu=e.EX,Su=e.Ln,Eu=e.wk,Au=e.xP,Mu=e.ko,Ou=e.iF,Lu=e.bc,Pu=e.B1,Du=e.RX,ju=e.lR,Hu=e.ag,Nu=e.tp,Uu=e.Tc,Wu=e.Hf,$u=e.zc,Ru=e._A,Bu=e.T_,Fu=e.td,_u=e.g0,zu=e.pd,Gu=e.th,Xu=e.VQ,Ku=e.DD,qu=e.tr,Zu=e.ul,Qu=e.Ag,Yu=e.Pc,ti=e.NU,ei=e.wB,ni=e.id,oi=e.MC,si=e.SZ;export{Va as ArrayNoKeyError,Ja as BasicTypes,ka as ImmutableTypes,Ia as PropWatches,Sa as RouteQuery,Ea as StateMismatchError,Aa as Subject,Ma as Subjective,Oa as SyncCallbackError,La as TagError,Pa as ValueSubject,Da as ValueSubjective,ja as ValueTypes,Ha as a,Na as addPaintRemoveAwait,Ua as appElements,Wa as array,$a as b,Ra as body,Ba as br,Fa as buildBeforeElement,_a as button,za as callback,Ga as callbackMaker,Xa as checkArrayValueChange,Ka as checkSimpleValueChange,qa as checkStillSubscription,Za as checkTagValueChange,Qa as checkTagValueChangeAndUpdate,Ya as combineLatest,tc as createHtmlSupport,ec as createTrigger,nc as deepClone,oc as deepEqual,sc as defineValueOn,rc as deleteContextSubContext,ac as deleteSimpleValue,cc as destroySupport,uc as dialog,ic as div,lc as empty,pc as fieldset,fc as firstTagRender,dc as footer,gc as forceUpdateExistingValue,hc as getBaseSupport,mc as getContextInCycle,bc as getDomMeta,vc as getDomTag,yc as getInnerHTML,xc as getNewGlobal,wc as getSupportOlderState,Cc as getTemplaterResult,Tc as guaranteeInsertBefore,Vc as h1,Jc as h2,kc as h3,Ic as h4,Sc as h5,Ec as h6,Ac as hasPropChanges,Mc as head,Oc as header,Lc as hmr,Pc as host,Dc as howToSetInputValue,jc as howToSetStandAloneAttr,Hc as hr,Nc as html,Uc as htmlDoc,Wc as htmlTag,$c as input,Rc as isArray,Bc as isFunction,Fc as isObject,_c as isPromise,zc as isSimpleType,Gc as isStaticTag,Xc as isSubjectInstance,Kc as isTagComponent,qc as label,Zc as legend,Qc as letProp,Yc as li,tu as link,eu as main,nu as meta,ou as noElement,su as noscript,ru as ol,au as onDestroy,cu as onFirstSubContext,uu as onInit,iu as oneRenderToSupport,lu as option,pu as output,fu as p,du as paint,gu as pipe,hu as pre,mu as providers,bu as reRenderTag,vu as renderSupport,yu as renderWithSupport,xu as section,wu as select,Cu as setBooleanAttribute,Tu as setNonFunctionInputValue,Vu as setSimpleAttribute,Ju as setUseMemory,ku as signal,Iu as small,Su as span,Eu as state,Au as states,Mu as strong,Ou as style,Lu as subject,Pu as subscribe,Du as subscribeWith,ju as sup,Hu as syncError,Nu as table,Uu as tag,Wu as tagElement,$u as tagValueUpdateHandler,Ru as tags,Bu as tbody,Fu as td,_u as textarea,zu as tfoot,Gu as th,Xu as thead,Ku as title,qu as tr,Zu as ul,Qu as upgradeBaseToSupport,Yu as valueToTagJsVar,ti as variablePrefix,ei as watch,ni as willCallback,oi as willPromise,si as willSubscribe};
//# sourceMappingURL=bundle.js.map